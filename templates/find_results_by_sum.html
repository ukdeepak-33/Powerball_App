{% extends "base.html" %}

{% block title %}Find Results by Sum{% endblock %}

{% block page_heading %}Find Results by Sum{% endblock %}

{% block content %}
<div class="card p-6 bg-white rounded-lg shadow-lg">
    <h2 class="text-2xl font-bold mb-4 text-gray-800">Search Historical Draws by Sum</h2>
    
    <form action="{{ url_for('find_results_by_sum_route') }}" method="post" class="space-y-4">
        <div class="form-group">
            <label for="target_sum" class="block text-gray-700 text-sm font-bold mb-2">Enter Target Sum (15-345):</label>
            <input type="number" name="target_sum" id="target_sum" min="15" max="345" 
                   value="{{ target_sum | default('') }}" {# Preserve value after submission #}
                   class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                   placeholder="e.g., 100">
        </div>

        <div class="form-group">
            <label for="sort_by" class="block text-gray-700 text-sm font-bold mb-2">Sort Results By:</label>
            <select name="sort_by" id="sort_by" class="shadow border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                <option value="date_desc" {% if selected_sort_by == 'date_desc' %}selected{% endif %}>Draw Date (Newest First)</option>
                <option value="date_asc" {% if selected_sort_by == 'date_asc' %}selected{% endif %}>Draw Date (Oldest First)</option>
                <option value="balls_asc" {% if selected_sort_by == 'balls_asc' %}selected{% endif %}>White Balls (Ascending)</option>
                <option value="balls_desc" {% if selected_sort_by == 'balls_desc' %}selected{% endif %}>White Balls (Descending)</option>
            </select>
        </div>

        <button type="submit" class="btn-primary w-full mt-4">Find Results</button>
    </form>

    {% if results %}
        <div class="mt-8">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">Draws with Sum: {{ target_sum }}</h3>
            <div class="overflow-x-auto">
                <table class="min-w-full bg-white border border-gray-200 rounded-lg shadow-md">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-4 py-2 border-b-2 border-gray-200 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Draw Date</th>
                            <th class="px-4 py-2 border-b-2 border-gray-200 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">White Balls</th>
                            <th class="px-4 py-2 border-b-2 border-gray-200 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Powerball</th>
                            <th class="px-4 py-2 border-b-2 border-gray-200 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider">Sum</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in results %}
                        <tr class="hover:bg-gray-50">
                            <td class="px-4 py-2 border-b border-gray-200 text-sm text-gray-900">{{ row['Draw Date'] }}</td>
                            <td class="px-4 py-2 border-b border-gray-200 text-sm text-gray-900">
                                <span class="ball-sm">{{ row['Number 1'] }}</span>
                                <span class="ball-sm">{{ row['Number 2'] }}</span>
                                <span class="ball-sm">{{ row['Number 3'] }}</span>
                                <span class="ball-sm">{{ row['Number 4'] }}</span>
                                <span class="ball-sm">{{ row['Number 5'] }}</span>
                            </td>
                            <td class="px-4 py-2 border-b border-gray-200 text-sm text-gray-900">
                                <span class="ball-sm powerball-sm">{{ row['Powerball'] }}</span>
                            </td>
                            <td class="px-4 py-2 border-b border-gray-200 text-sm text-gray-900">{{ row['Sum'] }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    {% elif target_sum is not none %} {# Only show if a search was attempted but no results #}
        <div class="mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg text-yellow-800">
            No draws found with a sum of {{ target_sum }}.
        </div>
    {% endif %}
</div>
{% endblock %}
